---
title: 삼중항 손실
---

- 기준이 되는 Anchor 이미지와 같은 인물이지만 다른 사진 Positive, 그리고 다른 사람의 사진 Negative
- 이 세 이미지를 동시에 확인하였을 때 다음과 같은 결과를 기대한다:

$$
||f(A)-f(P)||^2_2\le||f(A)-f(N)||^2_2
$$

- 위 식이 성립하면 만족스럽지만, 두 거리 값이 거의 비슷할 경우 학습이 제대로 이루어지지 않을 수 있다.

$$
||f(A)-f(P)||^2_2+\alpha\le||f(A)-f(N)||^2_2
$$

- $d(A, P)=0.5, \alpha=0.2$ 일 때 $d(A, N)=0.51$ 이라면 식이 성립하지 않으므로 두 $d$ 값에 별로 차이가 없더라도 margin 을 통해 함수 $d$ 의 학습을 유도할 수 있게 된다.

### 삼중항 손실, 비용함수

$$
\mathcal{L}(A, P, N)=max(||f(A)-f(P)||^2-||f(A)-f(N)||^2+\alpha, 0)
$$

$$
J=\sum_{i=1}^m\mathcal{L}(A^{(i)}, P^{(i)}, N^{(i)})
$$

### 훈련

- 훈련 중 훈련 세트 안에서 A, P, N 쌍을 랜덤으로 선택한다면 $d(A, P)+\alpha\le d(A, N)$ 은 쉽게 성립한다.

- 결론적으로, 삼중항 손실은 같은 클래스는 더 가깝게, 다른 클래스는 더 멀리 떨어지도록 학습시키기 위해 설계된 손실 함수이며, **마진**을 도입하여 학습이 더욱 잘 이루어지도록 만든다.