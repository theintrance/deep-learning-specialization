---
title: 스타일 비용 함수
---

### Neural Style Transfer: 스타일 비용 함수

1. **스타일 비용 함수란?**
    - 스타일 이미지(S)와 생성된 이미지(G) 간의 스타일 유사도를 측정하는 함수.
    - 채널 간 상관 관계(Gram matrix)를 이용해 이미지의 패턴과 텍스처를 비교.
2. **Gram matrix(그람 행렬) 계산**:
    - CNN의 특정 레이어에서 이미지의 채널 간 상관 관계를 계산한 행렬.
    - 각 채널의 활성화 값들이 얼마나 함께 변화하는지 측정.
    
    $$
    G^{[l]}_{kk'} = \sum_{i=1}^{n_h} \sum_{j=1}^{n_w} a_{ijk}^{[l]} \cdot a_{ijk'}^{[l]}
    $$
    
3. **스타일 비용 함수 계산**:
    - 스타일 이미지(G_S)와 생성된 이미지(G_G)의 Gram matrix 차이를 제곱하여 합한 값으로 스타일 비용을 계산.
    
    $$
    J_{style}^{[l]}(S, G) = \frac{1}{2 n_c^{[l]} n_h^{[l]} n_w^{[l]}} \sum_{k=1}^{n_c} \sum_{k'=1}^{n_c} \left( G^{[l](S)}_{kk'} - G^{[l](G)}_{kk'} \right)
    $$
    
4. **여러 레이어 사용**:
    - 여러 레이어에서 스타일 비용을 계산하고 합산해 최종 스타일 비용을 구함.
5. **직관적인 이해**:
    - 스타일 매트릭스는 이미지의 패턴과 텍스처가 어떻게 서로 상관되어 있는지를 나타냄.
    - 두 이미지의 스타일 매트릭스가 비슷하면, 생성된 이미지도 스타일 이미지와 유사한 패턴과 텍스처를 가짐.