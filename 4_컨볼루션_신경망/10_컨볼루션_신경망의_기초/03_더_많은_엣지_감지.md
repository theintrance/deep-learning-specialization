---
title: 더 많은 엣지 감지
---

![](/assets/ce08f99d-1dd2-4694-86ec-6b44a3b21274.png)

- 지난시간 예로 들었던 컨볼브 예시
- 여기서 이미지를 좌우 반전하면, 컨볼브의 결과는 다음과 같다

```python
data = np.array([
    [10, 10, 10, 0, 0, 0],
    [10, 10, 10, 0, 0, 0],
    [10, 10, 10, 0, 0, 0],
    [10, 10, 10, 0, 0, 0],
    [10, 10, 10, 0, 0, 0],
    [10, 10, 10, 0, 0, 0]
])
data = np.fliplr(data) # flip horizontally

kernel = np.array([
    [1, 0, -1],
    [1, 0, -1],
    [1, 0, -1]
])

result = conv2d(data, kernel)
print(result)
```

```python
[[  0 -30 -30   0]
 [  0 -30 -30   0]
 [  0 -30 -30   0]
 [  0 -30 -30   0]]
```

- 명암이 뒤바뀌게 된다.
- 이는 밝은 곳에서 어두운 곳으로 바뀌는 엣지와 어두운 곳에서 밝은 곳으로 변하는 엣지의 차이이며, 이 차이가 상관 없으면 결과 행열의 절대값을 취해도 상관없다.

```python
data = np.array([
    [10, 10, 10, 0, 0, 0],
    [10, 10, 10, 0, 0, 0],
    [10, 10, 10, 0, 0, 0],
    [0, 0, 0, 10, 10, 10],
    [0, 0, 0, 10, 10, 10],
    [0, 0, 0, 10, 10, 10]
])

kernel = np.array([
    [1, 1, 1],
    [0, 0, 0],
    [-1, -1, -1]
])

result = conv2d(data, kernel)
print(result)
```

```python
[[  0   0   0   0]
 [ 30  10 -10 -30]
 [ 30  10 -10 -30]
 [  0   0   0   0]]
```

- 여기서 양수인 30은 밝은 곳에서 어두운 곳으로 변하는 엣지이며, 음수인 -30은 그 반대의 엣지이다.
- 여기에 머신 러닝을 도입하여 더 나은 filter 를 만들어 내는 것이 목표이며 이는 수동으로 소벨 필터같은 특정 필터를 선정한 것보다 성능이 훨씬 좋음