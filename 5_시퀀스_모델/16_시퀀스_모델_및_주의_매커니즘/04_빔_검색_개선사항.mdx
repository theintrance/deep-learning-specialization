---
title: 빔 검색 개선사항
---

* 우리의 목표는 결국 아래 식을 최대화하는 $y$ 를 찾는 것이다.

$$
\prod_{t=1}^{T_y} P(y^{<t>} | x, y^{<1>}, ..., y^{<t-1>})
$$

$$
=P(y^{<1>}|x)P(y^{<2>}|x,y^{<1>})P(y^{<3>}|x,y^{<1>},y^{<2>})\dots
$$

* $P(x)$ 는 확률값이기 때문에, 이는 1 이하의 값이고 이렇게 작은 값을 계속 곱하게 되면 underflow 가 발생한다.
* 이를 방지하기 위해 위 식에 로그를 취해준다.

$$
\log \prod_{t=1}^{T_y} P(y^{<t>} | x, y^{<1>}, ..., y^{<t-1>}) = \sum_{t=1}^{T_y} \log P(y^{<t>} | x, y^{<1>}, ..., y^{<t-1>})
$$

* 이제 이 식을 최대화하는 것이 목표가 된다.

* 함수의 특성 상 문장이 길어질 수록 확률이 엄창나게 작아지기 때문에, 이에대한 패널티를 줄여주기 위해 정규화가 필요하다.

$$
\frac{1}{T_y^\alpha} \sum_{t=1}^{T_y} \log P(y^{<t>} | x, y^{<1>}, ..., y^{<t-1>})
$$

* 여기서 $\alpha$ 는 얼마나 정규화를 할 것인지 결정하는 하이퍼파라미터이다.
* 빔 검색을 진행해가며 위 값을 최대로 만드는 문장을 선정하면 된다.

### 그럼 Beam width, $B$ 값은 어떻게 선정하나요

* $B$ 가 크면 넓은 검색 범위를 가질 수 있지만 속도는 느려진다.
* $B$ 가 너무 작으면 적은 가능성에서 탐색하기 떄문에 좋지않은 결과가 나올 수 있다.

* 아주 큰 제품들에서는 1000, 3000을 쓰는 경우도 있다.
* 결국 실제로 사용해보며 최적의 $B$ 값을 찾아야 한다.