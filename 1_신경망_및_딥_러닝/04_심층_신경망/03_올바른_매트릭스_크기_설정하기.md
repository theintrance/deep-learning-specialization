---
title: 올바른 매트릭스 크기 설정하기
---
L-Layer 구성을 위해 각 가중치, 바이어스 벡터의 크기를 설정하는 것은 중요하다.

$l$ 번째 레이어의 $w^{[l]}$ , $b^{[l]}$,  $z^{[l]}$,  $a^{[l]}$  의 크기는 다음과 같이 정의한다.

$$
w^{[l]}\rightarrow(n^{[l]}, n^{[l-l]})\\
b^{[l]}\rightarrow(n^{[l]}, 1)\\
z^{[l]}\rightarrow(n^{[l]}, 1)\\
a^{[l]}\rightarrow(n^{[l]}, 1)\\

$$

![](/assets/ac9bbe00-2a53-42b9-9402-b07e8068a110.png)

각 레이어의 노드의 갯수는 3, 5, 6, 3, 1 인 4-Layer NN 이다. 

| $l$ | 0 | 1 | 2 | 3 | 4 |
| --- | --- | --- | --- | --- | --- |
| $w^{[l]}$  | X | (5, 3) | (6, 5) | (3, 5) | (1, 3) |
| $b^{[l]}$  | X | (5, 1) | (6, 1) | (3, 1) | (1, 1) |
| $z^{[l]}$  | X | (5, 1) | (6, 1) | (3, 1) | (1, 1) |
| $a^{[l]}$  | (3, 1) | (5, 1) | (6, 1) | (3, 1) | (1, 1) |

m개의 모든 훈련 예제의 벡터를 $X$ 로 표현했을 때 아래가 성립함

$$
A^{[0]}=X\rightarrow(n_x, m)\\
\therefore w^{[1]}\rightarrow (n^{[1]}, m)
$$

역방향 전파 시의 변수들 $dZ$, $dA$ 등의 변수들도 해당 벡터의 크기를 따라감

$$
\text{dimension of }dZ^{[l]}=\text{dimension of }Z^{[l]}\\\text{dimension of }dA^{[l]}=\text{dimension of }A^{[l]}
$$