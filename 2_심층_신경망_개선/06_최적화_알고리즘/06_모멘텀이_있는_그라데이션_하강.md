---
title: 모멘텀이 있는 그라데이션 하강
---
- 경사 하강에 지수 가중 평균을 도입한다.

$$
v_{dW}=\beta v_{dW}+(1-\beta)dW\\
v_{db}=\beta v_{db}+(1-\beta)db\\
w:=w-v_\alpha{dw}\\
b:=b-v_\alpha{db}
$$

- 이는 역전파로 계산한 기울기로 가중치를 업데이트 할 때 경사 하강의 변동성을 감소시킨다

![](/assets/d229e6b1-043d-43fd-966f-b903dbcb8b4e.png)

- 파란색: 적당한 learning rate 를 가진 경사 하강 과정
- 보라색: learning rate 가 너무 커 발산하는 경사 하강
- 빨간색: 지수 가중 평균을 사용한 단순화 된 경사 하강

- $\frac{v_{dW}}{1-\beta_t}$ 을 도입하여 초반 바이어스를 보정할 수는 있겠으나 10번 iteration 만 해도 미분 값이 충분이 warm-up 되어 많이 사용하지는 않는다.

$$
v_{dW}=\beta v_{dW}+dW
$$

- 이처럼 $(1-\beta)$ 항을 생략하여 사용하는 경우도 있다.
- 새로운 데이터가 이미 가중치가 적용된 값일 때 사용한다.
- 일반적인 경우에는 가중치 항을 포함한 형태의 EMA 수식을 사용하는 것이 더 정확하다.